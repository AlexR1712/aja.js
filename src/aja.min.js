/**
 * aja.js <https://github.com/krampstudio/aja.js
 *  
 * @version <=%pkg.version%>
 * @author Bertrand Chevrier <chevrier.bertrand@gmail.com> Â© 2014
 * @license MIT
**/
!function(a){"use strict";var b=["html","json","jsonp"],c=["get","post","delete","head","put","options"],d=function g(){var b={},c={},d={url:function(a){return i.call(this,"url",a,e.string)},sync:function(a){return i.call(this,"sync",a,e.bool)},cache:function(a){return i.call(this,"cache",a,e.bool)},type:function(a){return i.call(this,"type",a,e.type)},header:function(a,c){return b.headers=b.headers||{},e.string(a),"undefined"!=typeof c?(e.string(c),b.headers[a]=c,this):b.headers[a]},auth:function(a,c){return e.string(a),e.string(c),b.auth={user:a,passwd:c},this},method:function(a){return i.call(this,"method",a,e.method,function(a){return"post"===a.toLowerCase()&&this.header("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a})},queryString:function(a){return i.call(this,"queryString",a,e.queryString)},data:function(a){return i.call(this,"data",a,e.plainObject)},body:function(a){return i.call(this,"body",a,null,function(a){if("object"==typeof a){if(!(a instanceof FormData)){try{a=JSON.stringify(a)}catch(b){throw new TypeError("Unable to stringify body's content : "+b.name)}this.header("Content-Type","application/json")}}else a+="";return a})},into:function(a){return i.call(this,"into",a,e.selector,function(a){return"string"==typeof a?document.querySelectorAll(a):a instanceof HTMLElement?[a]:void 0})},jsonPaddingName:function(a){return i.call(this,"jsonPaddingName",a,e.string)},jsonPadding:function(a){return i.call(this,"jsonPadding",a,e.func)},on:function(a,b){return"function"==typeof b&&(c[a]=c[a]||[],c[a].push(b)),this},off:function(a){return c[a]=[],this},trigger:function(a,b){var d=this,e=function(a,b){c[a]instanceof Array&&c[a].forEach(function(a){a.call(d,b)})};if("undefined"!=typeof a){a+="";var f=/^([0-9])([0-9x])([0-9x])$/i,g=a.match(f);g&&g.length>3?Object.keys(c).forEach(function(a){var c=a.match(f);!(c&&c.length>3&&g[1]===c[1])||"x"!==c[2]&&g[2]!==c[2]||"x"!==c[3]&&g[3]!==c[3]||e(a,b)}):c[a]&&e(a,b)}return this},go:function(){var a=b.type||(b.into?"html":"json"),c=k();return"function"==typeof h[a]?h[a].call(this,c):void 0}},h={json:function(a){var b=this;h._xhr.call(this,a,function(a){try{a=JSON.parse(a)}catch(c){return b.trigger("error",c),null}return a})},html:function(a){h._xhr.call(this,a,function(a){return b.into&&b.into.length&&b.into.forEach(function(b){b.innerHTML=a}),a})},_xhr:function(a,c){var d,e,f=this,g=b.method||"get",h=b.sync!==!0,i=new XMLHttpRequest,k=(b.queryString,b.data),l=b.body,m=[];if(k&&j(g)){l=l||"";for(d in k)l+=d+"="+k[d]+"\n\r"}if(m=[g,a,h],b.auth&&(m.push(b.auth.user),m.push(b.auth.passwd)),i.open.apply(i,m),b.headers)for(e in b.headers)i.setRequestHeader(e,b.headers[e]);i.onprogress=function(a){a.lengthComputable&&f.trigger("progress",a.loaded/a.total)},i.onload=function(){var a=i.responseText;this.status>=200&&this.status<300&&("function"==typeof c&&(a=c(a)),f.trigger("success",a)),f.trigger(this.status,a),f.trigger("end",a)},i.onerror=function(a){f.trigger("error",a,arguments)},i.send(l)},jsonp:function(c){var d,e=this,h=document.querySelector("head"),i=b.sync!==!0,j=b.jsonPaddingName||"callback",k=b.jsonPadding||"_padd"+(new Date).getTime()+Math.floor(1e4*Math.random()),l={};if(g[k])throw new Error("Padding "+k+"  already exists. It must be unique.");/^ajajsonp_/.test(k)||(k="ajajsonp_"+k),a[k]=function(b){e.trigger("success",b),h.removeChild(d),a[k]=void 0},l[j]=k,c=f(c,l),d=document.createElement("script"),d.async=i,d.src=c,d.onerror=function(){e.trigger("error",arguments),h.removeChild(d),a[k]=void 0},h.appendChild(d)}},i=function(a,c,d,f){if("undefined"!=typeof c){if("function"==typeof d)try{c=d.call(e,c)}catch(g){throw new TypeError("Failed to set "+a+" : "+g.message)}return b[a]="function"==typeof f?f.call(this,c):c,this}return"undefined"===b[a]?null:b[a]},j=function(){var a=b.method||"get";return["post","put"].indexOf(a)>-1},k=function(){var a=b.url,c="undefined"!=typeof b.cache?!!b.cache:!0,d=b.queryString,e=b.data;return c===!1&&(d+="ajabuster="+(new Date).getTime()),a=f(a,d),e&&!j()&&(a=f(a,e)),a};return d},e={bool:function(a){return!!a},string:function(a){if("string"!=typeof a)throw new TypeError("a string is expected, but "+a+" ["+typeof a+"] given");return a},plainObject:function(a){if("object"!=typeof a||a.constructor!==Object)throw new TypeError("an object is expected, but "+a+"  ["+typeof a+"] given");return a},type:function(a){if(a=this.string(a),b.indexOf(a.toLowerCase())<0)throw new TypeError("a type in ["+b.join(", ")+"] is expected, but "+a+" given");return a.toLowerCase()},method:function(a){if(a=this.string(a),c.indexOf(a.toLowerCase())<0)throw new TypeError("a method in ["+c.join(", ")+"] is expected, but "+a+" given");return a.toLowerCase()},queryString:function(a){var b={};return"string"==typeof a?a.replace("?","").split("&").forEach(function(a){var c=a.split("=");2===c.length&&(b[decodeURIComponent(c[0])]=decodeURIComponent(c[1]))}):b=a,this.plainObject(b)},selector:function(a){if("string"!=typeof a&&!(a instanceof HTMLElement))throw new TypeError("a selector or an HTMLElement is expected, "+a+" ["+typeof a+"] given");return a},func:function(a){if(a=this.string(a),!/^([a-zA-Z_]{1})([a-zA-Z0-9_\-])+$/.test(a))throw new TypeError("a valid function name is expected, "+a+" ["+typeof a+"] given");return a}},f=function(a,b){var c;if(a=a||"",b){-1===a.indexOf("?")&&(a+="?");for(c in b)a+="&"+encodeURIComponent(c)+"="+encodeURIComponent(b[c])}return a};a.aja=a.aja||d}(window);
//# sourceMappingURL=aja.min.js.map